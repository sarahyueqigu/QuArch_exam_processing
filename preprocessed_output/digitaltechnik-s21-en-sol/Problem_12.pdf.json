{
    "problem": "12",
    "problem_context": "A systolic array consists of 4x4 Processing Elements (PEs), interconnected as shown in Figure 1. The inputs of the systolic array are labeled as H0, H1, H2, H3 and V0, V1, V2, V3. Figure 2 shows the PE logic, which performs a multiply and accumulate MAC operation and saves the result to an internal register (reg). Figure 2 also shows how each PE propagates its inputs. We make the following assumptions:\n\n\u02c6 The latency of each MAC operation is one cycle.\n\n\u02c6 The propagation of the values from i0 to o0, and from i1 to o1, takes one cycle.\n\n\u02c6 The initial values of all internal registers is zero.\n\nPE00 PE01\n\nPE10 PE11\n\nPE02\n\nPE12\n\nPE20 PE21 PE22\n\nH0\n\nH1\n\nH2\n\nV0 V1 V2\n\nPE03\n\nPE13\n\nPE23\n\nV3\n\nPE30 PE31 PE32H3 PE33\n\nFigure 1: PE array\n\no0 = i0\n\no0\n\no1\n\ni0\n\ni1\n\no1 = i1\nreg = i0*i1+ reg\n\nProcessing Element (PE)\n\nreg\n\nFigure 2: Processing Element (PE)\n\nYour goal is to use the example systolic array shown in Figure 1 to perform the convolution (~) of a 3x3 image (matrix I3x3) with four 2x2 filters (matrices A2x2, B2x2, C2x2, and D2x2), to obtain four 2x2 outputs (matrices W2x2, X2x2, Y2x2, and Z2x2):\n\nI00 I01 I02\nI10 I11 I12\nI20 I21 I22\n\n(~)\nA00 A01\n\nA10 A11\n=\n\nW00 W01\n\nW10 W11\n\nI00 I01 I02\nI10 I11 I12\nI20 I21 I22\n\n(~)\nB00 B01\n\nB10 B11\n=\n\nX00 X01\n\nX10 X11\n\nI00 I01 I02\nI10 I11 I12\nI20 I21 I22\n\n(~)\nC00 C01\n\nC10 C11\n=\n\nY00 Y01\n\nY10 Y11\n\nI00 I01 I02\nI10 I11 I12\nI20 I21 I22\n\n(~)\nD00 D01\n\nD10 D11\n=\n\nZ00 Z01\n\nZ10 Z11\n\nAs an example, the convolution of the matrix I3x3 with the filter A2x2 is computed as follows:\n\n\u02c6 W00 = I00 \u2217A00 + I01 \u2217A01 + I10 \u2217A10 + I11 \u2217A11\n\n\u02c6 W01 = I01 \u2217A00 + I02 \u2217A01 + I11 \u2217A10 + I12 \u2217A11\n\n\u02c6 W10 = I10 \u2217A00 + I11 \u2217A01 + I20 \u2217A10 + I21 \u2217A11\n\n\u02c6 W11 = I11 \u2217A00 + I12 \u2217A01 + I21 \u2217A10 + I22 \u2217A11",
    "problem_question": "You should compute the four convolutions in the minimum possible number of cycles. Fill the following table with:\n\n1. The input elements (from matrices I3x3, A2x2, B2x2, C2x2, and D2x2) in the correct input ports of the systolic array (H0, H1, H2, H3 and V0, V1, V2, V3). (Hint: If necessary, an input element can be concurrently streamed into several input ports of the array.)\n\n2. The output values and the corresponding PE where the output elements (of matrices W2x2, X2x2, Y2x2, and Z2x2) are generated.\n\nFill the blanks only with relevant information.",
    "problem_solution": "cycle H0 H1 H2 H3 V0 V1 V2 V3 PE00 PE01 PE02 PE03 PE10 PE11 PE12 PE13 PE20 PE21 PE22 PE23 PE30 PE31 PE32 PE33\n\n0 A00 I00 \n1 A01 B00 I01 I01 \n2 A10 B01 C00 I10 I02 I10 \n3 A11 B10 C01 D00 I11 I11 I11 I11 W00 \n\n4 B11 C10 D01 I12 I20 I12 W01 X00 \n\n5 C11 D10 I21 I21 W10 X01 Y00 \n\n6 D11 I22 W11 X10 Y01 Z00 \n\n7 X11 Y10 Z01 \n\n8 Y11 Z10 \n\n9 Z11",
    "problem_context_figures": [],
    "problem_solution_figures": []
}